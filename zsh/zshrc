# Zinit setup
ZINIT_HOME="${XDG_DATA_HOME:-${HOME}/.local/share}/zinit/zinit.git"
[ ! -d "$ZINIT_HOME" ] && mkdir -p "$(dirname $ZINIT_HOME)"
[ ! -d "$ZINIT_HOME/.git" ] && git clone https://github.com/zdharma-continuum/zinit.git "$ZINIT_HOME"
source "${ZINIT_HOME}/zinit.zsh"

# Tmux config (must be set before loading tmux plugin)
ZSH_TMUX_CONFIG="${HOME}/.config/tmux/tmux.conf"

# OMZ plugins (loaded with turbo mode for speed)
zinit wait lucid for \
  OMZP::bazel \
  OMZP::fzf \
  OMZP::git \
  OMZP::git-auto-fetch \
  OMZP::git-extras \
  OMZP::history \
  OMZP::tmux \
  OMZP::zoxide

# Third-party OMZ plugin
zinit ice wait lucid
zinit light sheeki03/ohmyzsh-tirith

# Completions and autosuggestions (turbo mode)
zinit wait lucid for \
  atload"zicompinit; zicdreplay" blockf \
  zsh-users/zsh-completions \
  atload"_zsh_autosuggest_start" \
  zsh-users/zsh-autosuggestions

# Pure prompt (loaded synchronously - needed for prompt)
zinit ice pick"async.zsh" src"pure.zsh"
zinit light sindresorhus/pure

config_dir="${HOME}/.zsh"
for file in "${config_dir}"/*.zsh; do
  if [[ -f "$file" ]]; then
    source "$file"
  fi
done
